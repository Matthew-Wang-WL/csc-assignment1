<div style="padding: 20px;">
    <form>
        <input type="file" id="imageFile" accept="image/*" />
        <br />
        <input type="button" value="Upload" id="upload" />
    </form>

    <label for="link">Link to uploaded image:</label>
    <input onclick="this.select()" type="text" id="link" name="link" value="" readonly/>
    
    <br/>
    <span id="errMsg" style="color:red;"></span>

    <br />
    <div id="displayContainer">
        <div id="display">
            <span id="loader_text"></span>
            <img src="~/loaders/loading.gif" id="loader" />
        </div>
    </div>
</div>

@section scripts {

    <script type="text/javascript">
        $(document).ready(function () {
            $('#display').hide();

            $('#upload').click(function () {
                $('#display').show();
                $('#loader_text').text("Uploading image");
                $('#errMsg').hide()

                var data = new FormData();
                var imageFile = document.getElementById("imageFile").files[0];
                data.append('imageFile', imageFile);
                $.ajax({
                    url: '/api/amazons3',
                    processData: false,
                    contentType: false,
                    data: data,
                    method: "POST",
                    dataType: "json",
                }).done(function (result) {
                    $('#display').hide();

                    $('#link').val(result);
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    $('#display').hide();
                    $('#errMsg').text(`${jqXHR.status} ${jqXHR.statusText}. ${jqXHR.responseJSON.Message}`);
                    $('#errMsg').show()
                });
            });
        });
    </script>

}